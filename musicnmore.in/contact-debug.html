<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Form Debug - M&M Studio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #ff6b6b;
            outline: none;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        .btn:hover {
            background: #ff5252;
        }
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        .back-link {
            text-align: center;
            margin-top: 20px;
        }
        .back-link a {
            color: #ff6b6b;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="header">
            <h1>üêõ Contact Form Debug</h1>
            <p>Direct test of Formspree ID: <strong>xblggydl</strong></p>
            <p>This form bypasses all security checks for debugging.</p>
        </div>

        <!-- Simple Direct Form -->
        <form id="debugContactForm" action="https://formspree.io/f/xblggydl" method="POST">
            <input type="hidden" name="_subject" value="DEBUG - Contact Form Test - M&M Studio">
            <input type="hidden" name="_captcha" value="false">
            <input type="hidden" name="debug_mode" value="true">
            <input type="hidden" name="timestamp" value="">
            
            <div class="form-group">
                <label for="name">Your Name: *</label>
                <input type="text" id="name" name="name" value="Debug Test User" required>
            </div>
            
            <div class="form-group">
                <label for="email">Your Email: *</label>
                <input type="email" id="email" name="email" value="debug@test.com" required>
            </div>
            
            <div class="form-group">
                <label for="phone">Your Phone:</label>
                <input type="tel" id="phone" name="phone" value="+91 9876543210">
            </div>
            
            <div class="form-group">
                <label for="inquiry_type">Inquiry Type: *</label>
                <select id="inquiry_type" name="inquiry_type" required>
                    <option value="">Select inquiry type</option>
                    <option value="Debug Test" selected>Debug Test</option>
                    <option value="General Question">General Question</option>
                    <option value="Booking Inquiry">Booking Inquiry</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="message">Message: *</label>
                <textarea id="message" name="message" rows="4" required>This is a debug test message to verify that the contact form with Formspree ID xblggydl is working correctly. Please confirm receipt of this message.</textarea>
            </div>
            
            <button type="submit" class="btn">Send Debug Message</button>
        </form>

        <div id="status"></div>
        <div id="debug-info" class="debug-info" style="display: none;"></div>

        <!-- Alternative Test Methods -->
        <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee;">
            <h3>Alternative Test Methods:</h3>
            <button class="btn" onclick="testWithFetch()" style="margin: 5px 0;">Test with Fetch API</button>
            <button class="btn" onclick="testWithAjax()" style="margin: 5px 0;">Test with XMLHttpRequest</button>
            <button class="btn" onclick="testFormspreeEndpoint()" style="margin: 5px 0;">Test Formspree Endpoint</button>
        </div>

        <div class="back-link">
            <a href="index.html">‚Üê Back to Main Website</a> | 
            <a href="test-forms.html">‚Üê Back to Form Tests</a>
        </div>
    </div>

    <script>
        // Set timestamp
        document.querySelector('input[name="timestamp"]').value = new Date().toISOString();

        // Handle form submission
        document.getElementById('debugContactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            await handleDebugSubmission(this);
        });

        async function handleDebugSubmission(form) {
            const statusDiv = document.getElementById('status');
            const debugDiv = document.getElementById('debug-info');
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;

            try {
                // Show loading
                submitBtn.textContent = 'Sending...';
                submitBtn.disabled = true;
                statusDiv.innerHTML = '<div class="info">üì§ Sending debug message...</div>';
                
                // Show debug info
                debugDiv.style.display = 'block';
                debugDiv.textContent = `Debug Information:
Form Action: ${form.action}
Method: ${form.method}
Timestamp: ${new Date().toISOString()}
Form ID: xblggydl
Status: Submitting...`;

                // Prepare form data
                const formData = new FormData(form);
                
                // Log form data
                let formDataLog = '\nForm Data:\n';
                for (let [key, value] of formData.entries()) {
                    formDataLog += `${key}: ${value}\n`;
                }
                debugDiv.textContent += formDataLog;

                // Submit form
                const response = await fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                debugDiv.textContent += `\nResponse Status: ${response.status}`;
                debugDiv.textContent += `\nResponse OK: ${response.ok}`;

                if (response.ok) {
                    statusDiv.innerHTML = `
                        <div class="success">
                            ‚úÖ <strong>SUCCESS!</strong><br>
                            Message sent successfully to Formspree ID: xblggydl<br>
                            Status: ${response.status}<br>
                            Check your email for the submission.
                        </div>
                    `;
                    debugDiv.textContent += '\n‚úÖ Form submission successful!';
                } else {
                    const responseText = await response.text();
                    debugDiv.textContent += `\nResponse Text: ${responseText}`;
                    
                    let errorData = {};
                    try {
                        errorData = JSON.parse(responseText);
                    } catch (e) {
                        // Response is not JSON
                    }

                    let errorMessage = `HTTP ${response.status}`;
                    if (errorData.errors) {
                        errorMessage = errorData.errors.map(e => e.message || e).join(', ');
                    } else if (errorData.error) {
                        errorMessage = errorData.error;
                    }

                    statusDiv.innerHTML = `
                        <div class="error">
                            ‚ùå <strong>FAILED</strong><br>
                            Error: ${errorMessage}<br>
                            Status: ${response.status}<br>
                            Form ID: xblggydl
                        </div>
                    `;
                    debugDiv.textContent += `\n‚ùå Error: ${errorMessage}`;
                }
            } catch (error) {
                console.error('Debug form error:', error);
                statusDiv.innerHTML = `
                    <div class="error">
                        ‚ùå <strong>NETWORK ERROR</strong><br>
                        Error: ${error.message}<br>
                        Check console for details.
                    </div>
                `;
                debugDiv.textContent += `\n‚ùå Network Error: ${error.message}`;
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }

        async function testWithFetch() {
            const statusDiv = document.getElementById('status');
            const debugDiv = document.getElementById('debug-info');
            
            statusDiv.innerHTML = '<div class="info">Testing with Fetch API...</div>';
            debugDiv.style.display = 'block';
            debugDiv.textContent = 'Testing Fetch API submission...';

            try {
                const response = await fetch('https://formspree.io/f/xblggydl', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: 'Fetch Test User',
                        email: 'fetch@test.com',
                        message: 'This is a test message using Fetch API',
                        test_method: 'fetch_api',
                        timestamp: new Date().toISOString()
                    })
                });

                debugDiv.textContent += `\nFetch Response Status: ${response.status}`;
                
                if (response.ok) {
                    statusDiv.innerHTML = '<div class="success">‚úÖ Fetch API test successful!</div>';
                } else {
                    const errorText = await response.text();
                    statusDiv.innerHTML = `<div class="error">‚ùå Fetch API test failed: ${response.status}</div>`;
                    debugDiv.textContent += `\nError: ${errorText}`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">‚ùå Fetch API error: ${error.message}</div>`;
                debugDiv.textContent += `\nFetch Error: ${error.message}`;
            }
        }

        async function testWithAjax() {
            const statusDiv = document.getElementById('status');
            const debugDiv = document.getElementById('debug-info');
            
            statusDiv.innerHTML = '<div class="info">Testing with XMLHttpRequest...</div>';
            debugDiv.style.display = 'block';
            debugDiv.textContent = 'Testing XMLHttpRequest submission...';

            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'https://formspree.io/f/xblggydl');
            xhr.setRequestHeader('Accept', 'application/json');
            xhr.setRequestHeader('Content-Type', 'application/json');

            xhr.onload = function() {
                debugDiv.textContent += `\nXHR Response Status: ${xhr.status}`;
                
                if (xhr.status === 200) {
                    statusDiv.innerHTML = '<div class="success">‚úÖ XMLHttpRequest test successful!</div>';
                } else {
                    statusDiv.innerHTML = `<div class="error">‚ùå XMLHttpRequest test failed: ${xhr.status}</div>`;
                    debugDiv.textContent += `\nError: ${xhr.responseText}`;
                }
            };

            xhr.onerror = function() {
                statusDiv.innerHTML = '<div class="error">‚ùå XMLHttpRequest network error</div>';
                debugDiv.textContent += '\nXHR Network Error';
            };

            xhr.send(JSON.stringify({
                name: 'XHR Test User',
                email: 'xhr@test.com',
                message: 'This is a test message using XMLHttpRequest',
                test_method: 'xhr',
                timestamp: new Date().toISOString()
            }));
        }

        async function testFormspreeEndpoint() {
            const statusDiv = document.getElementById('status');
            const debugDiv = document.getElementById('debug-info');
            
            statusDiv.innerHTML = '<div class="info">Testing Formspree endpoint...</div>';
            debugDiv.style.display = 'block';
            debugDiv.textContent = 'Testing Formspree endpoint availability...';

            try {
                // Test if endpoint is reachable
                const response = await fetch('https://formspree.io/f/xblggydl', {
                    method: 'GET'
                });

                debugDiv.textContent += `\nEndpoint Response Status: ${response.status}`;
                
                if (response.status === 405) {
                    // Method Not Allowed is expected for GET request
                    statusDiv.innerHTML = '<div class="success">‚úÖ Formspree endpoint is reachable!</div>';
                    debugDiv.textContent += '\n‚úÖ Endpoint is active (405 Method Not Allowed is expected for GET)';
                } else {
                    statusDiv.innerHTML = `<div class="info">‚ÑπÔ∏è Endpoint responded with status: ${response.status}</div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div class="error">‚ùå Cannot reach Formspree endpoint: ${error.message}</div>`;
                debugDiv.textContent += `\nEndpoint Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>